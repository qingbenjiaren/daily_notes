产品学习
	lucene是solr,es的底层技术，上节课讲原理性知识：es,solr底层原理，Lucene构建搜索原理，Lucene也可以实现搜索
	问题：为什么不使用Lucene技术进行开发搜索呢？
		Lucene不是一个现成的产品，只是一套用来开发搜索的java API，可以使用lucene开发搜索，但是开发成本和维护成本相当高
			
			索引库创建
			索引库的维护
			集群维护
			
			随着索引库的规模越来越庞大，那么这些东西应该怎么管理？集群怎么管理？
			
	搜索产品：
		1、solr
		2、elasticsearch ---实时性索引数据，大规模数据，es检索时候又明显的优势。
		
		Elastic Search
		
			底层Lucene：通过lucene开发了一个搜索产品
			向es发送http请求就可以操作索引库，用json作为文档序列化的格式
			
		为什么要使用es
			因为它优秀的性能
			GitHub就使用了solr
			SoundCloud:为1.8亿人提供即时而精确的音乐搜索服务
			百度
			
			
			我们也需要
				实际项目开发实战中，几乎每个系统都会有一个搜索的功能，当搜索做到一定程度时，维护和扩展
				起来难度就会慢慢变大，所以很多公司都会把搜索单独独立出一个模块。用ElasticSearch等来实现。不用担心因为数据过多变慢
				近年ElasticSearch发展迅猛，已经超过了其最初的纯搜索引擎角色，现在已经增加了数据聚合分析和可视化的特性
				
				
			ES有什么能力
				分布式
				近实时
				搜索
				聚合分析
			
			使用场景
				网站搜索
				
				日志分析
				
				数据预警
				
				商业智能，数据分析
				
			
			ES的架构：
				网关Gateway层
				DLD
				自动发现Discover,Script
					
				通信
				四大模块组件
					Index Module    Search Module   Mapping    River
					
					Mapping：映射，约束的规则
					River：
				RESTFUL接口层
					HTTP协议：9200
					JMX协议：9300
					
					
		ES集群
			伪集群（单机Node）
			
			文档得分计算：
				在进行搜索的时候，根据关键词进行文档搜索时，如何知道哪个文档是我们最需要的文档
				也就是最匹配搜索需求的文档。
				匹配方式：相关度得分计算，得分月高，匹配度越高，这个文档会显示在头条
				
				seo优化：
					百度交钱，认为设置boost（得分因子）
					
				所搜文档得分计算，采用数学统计算法
				1、布尔模型
				2、向量空间模型
				3、神经网络模型
				4、潜行语义索引模型
				
				ES采用布尔模型
				
					t:(term词条)
					p:query---查询
					d:document	一共出现在多少个文档
					idf(词条不限在文档的一个反转评率
					boost（d.field int d）1：得分加权因子
					lengthNorm(t.fired in d)字段长度对得分影响
					
					例如：10000文档，1号文档出现词语‘徐嘉欣’次数是100词，1号文档有1000单词
						ft(t in d):词语u“徐嘉欣”出现在一个文档中次数（文档供100词），词语出现
							tf = 1000/1000 = 0.1
						df(t in d)：单词文档的频率：DF表示这个单词出现在多少个文档中。DF反映了单词的区分度，DF越高，表示这个单词越普，区分度就越低，权重就越低
						所以就有了idf，反转平频率
						idf（反转频率）：df越高，权重越小
						
						tf*idf  ---DF越高，权重越小
							lg对数计算
						
						lengthNorm:表示field字段越长，越不重要，越短越重要。
						
			单节点
				伪集群（因为es本身是分布式架构，此时只用了一台机器，因此这也叫做集群，叫空集群）
					单机默认是5个primary shard 5个replica shard
					
				es数据存储方式：采用分片的存储方式，把数据储存在一个一个分片中，而分片又分布在不同的服务器，这样分担服务器压力
				
				创建索引库：默认创建5个primary shard已近存储在本地节点，空集群完全用来存储primary（0，1,2,3,4）
							没有机器存储副本节点
							一旦集群宕机，由于没有备份的节点，导致集群不可用
				
				是否可以设置分片的数量？答案是肯定的
					PUT /
						put索引时，在创建索引库的时候，指定主节点分片和副本的数量
								number_of_shards : 3创建3个primary shard
								number_of_replica: 1为每一个主分片创建一个副本分片，
								总共6个节点
						
				
			规划节点：
				各种集群的特点，认识清楚。。。。
					☆代表主节点
					●代表从节点
				分片节点
					边框线条粗：primary shard
					边框线条细：replica shard
				
				节点类型
					master节点
						维护集群状态，维护元数据
						存储数据
						设置方式：node.master: true   ---有参与选举的权利，选举为master的权利，能不能称为master需要看选举情况，候选master的节点
								  node.data:true   -----此节点既作为master候选节点，也可以存储数据
					数据节点
						只用来存数据的
						node.master:false 
						node.data:true  ---只能存储数据
					协调节点
						协调节点根据路由算法，把数据分配到某一个分片进行存储
						每一个节点都可以作为协调节点
				
				如果不对节点类型进行设置，那么每一个节点都有三种身份
					1、候选master
					2、存储数据
					3、协调节点
					
				当集群规模越来越大时，数据规模越来越大，节点越来越多，为了提高集群的性能，可以让集群节点的功能单一化（单一职能原则）
					例如：可以让master节点不存数据，只进行管理
						  slave node只存数据，不参与选举master
						  单独抽离一个协调节点，由协调节点算出应该到哪个节点去拿数据
						  如何让单独的一个节点做协调节点？
							需要从业务功能上做细致的划分，让所有请求都去找协调节点
						  
				当集群节点超过100个时，就应该考虑使用职责单一
				
				部落节点：用来维护超大规模集群的节点，部落节点管理多个es集群的
						
		重要名词：
			elastic search专业名词：
				index：索引
					对比关系型数据库，相当于数据库的database
				type：类型
					对比关系型数据库，相当于数据库的type（高版本就不要类型了，相当于一个库只有一个表）
				document：文档
					对比关系型数据库，相当于一行数据
				字段Field new Field("id","",Text)
					对比关系型数据库，相当于列Column
				mapping：映射（规则约束）
					对比关系型数据库，相当于模式：Schema约束
					
			
			restful请求：http://localhost:9200/java11/day41/1
			                                   索引库/类型/文档ID
											   
			mapping：对数据类型和规范的约束，如果price字段是整形，要加一条price是String的值会报错，
			
			
			在公司要开发搜索，首先应该做什么，
				首先应该定义mapping，
				要约束，就跟建表一样一样的
				首先需要先设计数据库
				
				这个很重要，mapping
			
			
下节课讲：脑裂，路由算法
ES一共5节课

				
				